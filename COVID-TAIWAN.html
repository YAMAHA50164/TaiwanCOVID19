<!DOCTYPE html>

<html>
    <head>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
        <script src="https://code.highcharts.com/highcharts.js"></script>
        <script src="https://code.highcharts.com/modules/data.js"></script>
        <script src="https://code.highcharts.com/modules/exporting.js"></script>
        
        <style>
            .highcharts-figure,
            .highcharts-data-table table {
                min-width: 310px;
                max-width: 800px;
                margin: 1em auto;
            }
            
            #container {
                min-width: 310px;
                max-width: 800px;
                height: 400px;
                margin: 0 auto;
            }

            
            .highcharts-data-table table {
                font-family: Verdana, sans-serif;
                border-collapse: collapse;
                border: 1px solid #ebebeb;
                margin: 10px auto;
                text-align: center;
                width: 100%;
                max-width: 500px;
            }
            
            .highcharts-data-table caption {
                padding: 1em 0;
                font-size: 1.2em;
                color: #555;
            }
            
            .highcharts-data-table th {
                font-weight: 600;
                padding: 0.5em;
            }
            
            .highcharts-data-table td,
            .highcharts-data-table th,
            .highcharts-data-table caption {
                padding: 0.5em;
            }
            
            .highcharts-data-table thead tr,
            .highcharts-data-table tr:nth-child(even) {
                background: #f8f8f8;
            }
            
            .highcharts-data-table tr:hover {
                background: #f1f7ff;
            }

        </style>
         
    </head>
    <body>
        <div id="container"></div>
        
        <pre id="csv" style="display:none">日期,確診數,7日平均,7日平均上升
            2022/4/1,236,,
            2022/4/2,404,,
            2022/4/3,280,,
            2022/4/4,275,,
            2022/4/5,281,,
            2022/4/6,259,,
            2022/4/7,531,324,
            2022/4/8,507,362,11.96
            2022/4/9,578,387,6.86
            2022/4/10,431,409,5.57
            2022/4/11,439,432,5.73
            2022/4/12,551,471,8.92
            2022/4/13,744,540,14.71
            2022/4/14,874,589,9.07
            2022/4/15,1209,689,17.02
            2022/4/16,1199,778,12.87
            2022/4/17,1210,889,14.30
            2022/4/18,1390,1025,15.27
            2022/4/19,1626,1179,14.98
            2022/4/20,2386,1413,19.90
            2022/4/21,2969,1713,21.17
            2022/4/22,3766,2078,21.33
            2022/4/23,4204,2507,20.66
            2022/4/24,5092,3062,22.12
            2022/4/25,5108,3593,17.35
            2022/4/26,6295,4260,18.56
            2022/4/27,8822,5179,21.58
            2022/4/28,11353,6377,23.12
            2022/4/29,11974,7550,18.39
            2022/4/30,15033,9097,20.49
            2022/5/1,17085,10810,18.83
            2022/5/2,17858,12631,16.85
            2022/5/3,23139,15038,19.05
            2022/5/4,28487,17847,18.68
            2022/5/5,30106,20526,15.01
            2022/5/6,36213,23989,16.87
            2022/5/7,46536,28489,18.76
            2022/5/8,44361,32386,13.68
            2022/5/9,40304,35592,9.90
            2022/5/10,50828,39548,11.11
            2022/5/11,57216,43652,10.38
            2022/5/12,65385,48692,11.55
            2022/5/13,65011,52806,8.45
            2022/5/14,64041,55307,4.74
            2022/5/15,68769,58793,6.30
            2022/5/16,61754,61858,5.21
            2022/5/17,65833,64001,3.47
            2022/5/18,85356,68021,6.28
            2022/5/19,90378,71592,5.25
            2022/5/20,85761,74556,4.14
            2022/5/21,84639,77499,3.95
            2022/5/22,79487,79030,1.98
            2022/5/23,66283,79677,0.82
            2022/5/24,82435,82048,2.98
            2022/5/25,89352,82619,0.70
            2022/5/26,81907,81409,-1.46
            2022/5/27,94855,82708,1.60
            2022/5/28,80881,82171,-0.65
            2022/5/29,76539,81750,-0.51
            2022/5/30,60103,80867,-1.08
            2022/5/31,80705,80620,-0.31
            2022/6/1,88293,80469,-0.19
            2022/6/2,76986,79766,-0.87
            2022/6/3,76564,77153,-3.28
            2022/6/4,68151,75334,-2.36
            2022/6/5,62110,73273,-2.74
            2022/6/6,53023,72262,-1.38
            2022/6/7,83207,72619,0.49
            2022/6/8,80223,71466,-1.59
            2022/6/9,72967,70892,-0.80
            2022/6/10,68347,69718,-1.66
            2022/6/11,79663,71363,2.36
            2022/6/12,50657,69727,-2.29
            2022/6/13,45110,68596,-1.62
            2022/6/14,66189,66165,-3.54
            2022/6/15,68965,64557,-2.43
            2022/6/16,63221,63165,-2.16
            2022/6/17,55261,61295,-2.96
            2022/6/18,53707,57587,-6.05
            2022/6/19,50636,57584,-0.01
            2022/6/20,35632,56230,-2.35
            2022/6/21,56404,54832,-2.49
            2022/6/22,52245,52444,-4.36
            2022/6/23,48356,50320,-4.05
            2022/6/24,45767,48964,-2.70
            2022/6/25,40293,47048,-3.91
            2022/6/26,39646,45478,-3.34
            2022/6/27,28580,44470,-2.22
            2022/6/28,44280,42738,-3.89
            2022/6/29,42204,41304,-3.36
            2022/6/30,38942,39959,-3.26
            2022/7/1,35800,38535,-3.56
            2022/7/2,34827,37754,-2.03
            2022/7/3,32681,36759,-2.64
            2022/7/4,32118,37265,1.37
            2022/7/5,36015,36084,-3.17
            2022/7/6,34577,34994,-3.02
            2022/7/7,31462,33926,-3.05
            2022/7/8,30477,33165,-2.24
            2022/7/9,28135,32209,-2.88
            2022/7/10,27844,31518,-2.15
            2022/7/11,19131,29663,-5.89
            2022/7/12,31297,28989,-2.27
            2022/7/13,29911,28322,-2.30
            2022/7/14,27684,27783,-1.91
            2022/7/15,25310,27045,-2.66
            2022/7/16,25296,26639,-1.50
            2022/7/17,24325,26136,-1.89
            2022/7/18,18003,25975,-0.62
            2022/7/19,27146,25382,-2.28
            2022/7/20,27196,24994,-1.53
            2022/7/21,25171,24635,-1.44
            2022/7/22,24093,24461,-0.71
            2022/7/23,22595,24076,-1.58
            2022/7/24,21737,23706,-1.54
            2022/7/25,17127,23581,-0.53
            2022/7/26,25071,23284,-1.26
            2022/7/27,25692,23069,-0.92
            2022/7/28,23971,22898,-0.74
            2022/7/29,23289,22783,-0.50
            2022/7/30,21501,22627,-0.69
            2022/7/31,21069,22531,-0.42
            2022/8/1,16584,22454,-0.34
            2022/8/2,23556,22237,-0.96
            2022/8/3,23919,21984,-1.14
            2022/8/4,22959,21840,-0.66
            2022/8/5,21869,21637,-0.93
            2022/8/6,19965,21417,-1.01
            2022/8/7,21771,21518,0.47
            2022/8/8,15412,21350,-0.78
            2022/8/9,23669,21366,0.08
            2022/8/10,23808,21350,-0.07
            2022/8/11,22909,21343,-0.03
            2022/8/12,21989,21360,0.08
            2022/8/13,21289,21550,0.89
            2022/8/14,21092,21453,-0.45
            2022/8/15,15792,21507,0.25
            2022/8/16,23172,21436,-0.33
            2022/8/17,24873,21588,0.71
            2022/8/18,23425,21662,0.34
            2022/8/19,22819,21780,0.55
            2022/8/20,22161,21905,0.57
            2022/8/21,22397,22091,0.85
            2022/8/22,16911,22251,0.72
            2022/8/23,26382,22710,2.06
            2022/8/24,28570,23238,2.33
            2022/8/25,27275,23788,2.37
            2022/8/26,26761,24351,2.37
            2022/8/27,25901,24885,2.19
            2022/8/28,26765,25509,2.51
            2022/8/29,20448,26015,1.98
            2022/8/30,31488,26744,2.80
            2022/8/31,34623,27609,3.23
            2022/9/1,34118,28586,3.54
            2022/9/2,33819,29595,3.53
            2022/9/3,32529,30541,3.20
            2022/9/4,34358,31626,3.55
            2022/9/5,24103,32148,1.65
            2022/9/6,36707,32894,2.32
            2022/9/7,41296,33847,2.90
            2022/9/8,35124,33991,0.42
            2022/9/9,34260,34054,0.19
            2022/9/10,35830,34525,1.38
            2022/9/11,32128,34207,-0.92
            2022/9/12,25583,34418,0.62
            2022/9/13,47051,35896,4.29
            2022/9/14,49708,37098,3.35
            2022/9/15,45470,38576,3.98
            2022/9/16,41670,39634,2.74
            2022/9/17,39628,40177,1.37
            2022/9/18,39569,41240,2.65
            2022/9/19,28449,41649,0.99
            2022/9/20,44747,41320,-0.79
            2022/9/21,46902,40919,-0.97
            2022/9/22,42470,40491,-1.05
            2022/9/23,40025,40256,-0.58
            2022/9/24,38371,40076,-0.45
            2022/9/25,38980,39992,-0.21
            2022/9/26,28513,40001,0.02
            2022/9/27,45850,40159,0.39            
            2022/9/28,48613,40403,0.61
            2022/9/29,44880,40747,0.85
            2022/9/30,43505,41245,1.22
            2022/10/01,43085,41918,1.63
        </pre>
        <input type="file" id="fileInput">
        <pre id="csv2"></pre>
    </body>
        
</html>

<script type="text/javascript">

    window.onload = function() {
        var fileInput = document.getElementById('fileInput');
        var fileDisplayArea = document.getElementById('csv2');
    
        fileInput.addEventListener('change', function(e) {
            var file = fileInput.files[0];  //'COVID-TAIWAN.csv';
            var textType = /text.*/;
    
            if (file.type.match(textType)) {
                var reader = new FileReader();
    
                reader.onload = function(e) {
                    fileDisplayArea.innerText = reader.result;
                }
    
                reader.readAsText(file);    
            } else {
                fileDisplayArea.innerText = "File not supported!"
            }
        });
    }

    var csvData = $.ajax({
        type: "GET",
        url: "https://yamaha50164.github.io/TaiwanCOVID19/COVID-TAIWAN.csv",
        success: function (data) {
            // $('#csv2').append(arrayToTable(Papa.parse(data).data));
        }
    });
    
    
    
    
    
    var charOption = {
    
        title: {
            text: 'COVID-19 In Taiwan 2022'
        },
        
        subtitle: {
            text: '手動更新CSV資料'
        },
        
        data: {
            csv: document.getElementById('csv').innerHTML
            // csv: 'COVID-TAIWAN.csv'
            
        },
        
        yAxis: [{ // Primary yAxis
            title: {
                text: '人數',
                style: {
                    color: Highcharts.getOptions().colors[1]
                }
            },
            labels: {
                format: '{value}',
                style: {
                    color: Highcharts.getOptions().colors[1]
                }
            }            
        }, { // Secondary yAxis
            title: {
                text: 'Ratio',
                style: {
                    color: Highcharts.getOptions().colors[0]
                }
            },
            labels: {
                format: '{value} %',
                style: {
                    color: Highcharts.getOptions().colors[0]
                }
            },
            opposite: true
        }],
        
        series: [{
            name:'確診數',
            type:'column',
            data: []
        },
        {
            name:'七日上升比例',
            type:'spline',
            data: []
        },{
            name:'七日平均上升',
            type:'spline',
            yAxis: 1,
            data: []
        }]
    }


    charOption.series[0].data.push(9);
    charOption.series[0].data.push(99);
    charOption.series[0].data.push(999);
    
    
    Highcharts.chart('container', charOption);
    
    
    
    // $.each(series_model, function(num, series) {
    //     var test = num;

    //     $.each(data, function(num, data) {

    //         var temp_data = {
    //             // name: data['stage_id'],
    //             name: data['name'],
    //             y: Number(data[series["name"]]),
    //             drilldown: data['stage_id'] + '#' + series["name"] + '#WIP',
    //         };

    //         series.data.push(temp_data);
    //     });
        
    //     options.series.push(series);
    // });
    
</script>


